<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self' data: https:;
  script-src 'self' 'unsafe-inline';
  style-src 'self' 'unsafe-inline' https://db.onlinewebfonts.com;
  font-src 'self' https://db.onlinewebfonts.com data:;
  img-src 'self' data: https:;
  connect-src 'self' https://api.mcsrvstat.us https://blissfull-production.up.railway.app;
">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BlissFullReloaded — Minecraft сервер</title>
<link href="https://db.onlinewebfonts.com/c/bf3f245b7cd53caea0cb07d265a64adc?family=Minecraftia+Regular" rel="stylesheet">
<style>
  @font-face {
    font-family: 'Minecraft';
    src: url('https://db.onlinewebfonts.com/t/bf3f245b7cd53caea0cb07d265a64adc.woff2') format('woff2'),
         url('https://db.onlinewebfonts.com/t/bf3f245b7cd53caea0cb07d265a64adc.woff') format('woff'),
         url('https://db.onlinewebfonts.com/t/bf3f245b7cd53caea0cb07d265a64adc.ttf') format('truetype');
    font-weight: normal;
  }
</style>
<style>
  :root {
    --bg: #080c10;
    --bg2: #0d1117;
    --bg3: #111820;
    --card: #0f1620;
    --border: #1e2d3d;
    --border2: #243447;
    --accent: #00d4ff;
    --accent2: #7b2fff;
    --accent3: #ff6b35;
    --gold: #f0c040;
    --text: #c8d8e8;
    --text2: #7a9ab8;
    --text3: #4a6a8a;
    --green: #00ff88;
    --red: #ff4455;
    --glow: 0 0 20px rgba(0,212,255,0.3);
    --glow2: 0 0 20px rgba(123,47,255,0.3);
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Minecraft', 'Minecraftia Regular', monospace;
    font-weight: 400;
    overflow-x: hidden;
    cursor: default;
    font-size: 13px;
    line-height: 1.6;
  }
  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none; z-index: 0; opacity: 0.6;
  }
  body::after {
    content: ''; position: fixed; inset: 0;
    background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.03) 2px, rgba(0,0,0,0.03) 4px);
    pointer-events: none; z-index: 1;
  }

  /* NAV */
  nav {
    position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
    background: rgba(8,12,16,0.92); backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 0 40px; height: 60px;
    display: flex; align-items: center; justify-content: space-between;
  }
  .nav-logo { font-family: 'Minecraft', monospace; font-size: 16px; color: var(--accent); text-shadow: var(--glow); letter-spacing: 2px; cursor: pointer; }
  .nav-logo span { color: var(--accent2); }
  .nav-links { display: flex; gap: 8px; align-items: center; }
  .nav-links a { color: var(--text2); text-decoration: none; font-size: 13px; font-weight: 600; letter-spacing: 1.5px; text-transform: uppercase; padding: 6px 14px; border-radius: 4px; transition: all 0.2s; cursor: pointer; }
  .nav-links a:hover, .nav-links a.active { color: var(--accent); background: rgba(0,212,255,0.08); }
  .nav-ip { font-family: 'Minecraft', monospace; font-size: 12px; color: var(--green); background: rgba(0,255,136,0.06); border: 1px solid rgba(0,255,136,0.2); padding: 5px 12px; border-radius: 4px; cursor: pointer; transition: all 0.2s; }
  .nav-ip:hover { background: rgba(0,255,136,0.12); border-color: var(--green); }
  .copy-toast { position: fixed; top: 70px; right: 40px; background: var(--green); color: #000; font-family: 'Minecraft', monospace; font-size: 12px; font-weight: 700; padding: 8px 16px; border-radius: 4px; z-index: 9999; opacity: 0; transform: translateY(-10px); transition: all 0.3s; pointer-events: none; }
  .copy-toast.show { opacity: 1; transform: translateY(0); }

  .page { display: none; padding-top: 60px; min-height: 100vh; position: relative; z-index: 2; }
  .page.active { display: block; }

  /* HOME */
  #home { display: none; min-height: 100vh; position: relative; overflow: hidden; }
  #home.active { display: block; }
  .hero-bg { position: absolute; top: 0; left: 0; right: 0; height: 100vh; pointer-events: none;
    background: radial-gradient(ellipse 80% 60% at 50% 0%, rgba(0,212,255,0.07) 0%, transparent 60%), radial-gradient(ellipse 60% 40% at 80% 80%, rgba(123,47,255,0.06) 0%, transparent 50%), radial-gradient(ellipse 40% 30% at 20% 60%, rgba(255,107,53,0.04) 0%, transparent 40%); }
  .hero-grid { position: absolute; top: 0; left: 0; right: 0; height: 100vh; pointer-events: none;
    background-image: linear-gradient(rgba(0,212,255,0.04) 1px, transparent 1px), linear-gradient(90deg, rgba(0,212,255,0.04) 1px, transparent 1px);
    background-size: 60px 60px; mask-image: radial-gradient(ellipse 80% 70% at 50% 30%, black 0%, transparent 80%); }
  .hero-content { position: relative; z-index: 2; padding: 100px 40px 80px; max-width: 1200px; margin: 0 auto; }
  .hero-badge { display: inline-flex; align-items: center; gap: 8px; background: rgba(0,255,136,0.08); border: 1px solid rgba(0,255,136,0.25); padding: 5px 14px; border-radius: 20px; font-size: 12px; font-weight: 600; color: var(--green); letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 32px; animation: fadeUp 0.6s ease both; }
  .hero-badge::before { content: ''; width: 6px; height: 6px; background: var(--green); border-radius: 50%; animation: pulse 2s infinite; }
  @keyframes pulse { 0%, 100% { opacity:1; box-shadow: 0 0 0 0 rgba(0,255,136,0.4); } 50% { opacity:0.7; box-shadow: 0 0 0 6px rgba(0,255,136,0); } }
  .hero-title { font-family: 'Minecraft', monospace; font-weight: normal; font-size: clamp(52px,8vw,96px); line-height: 1; letter-spacing: -1px; animation: fadeUp 0.6s 0.1s ease both; }
  .hero-title .line1 { color: #fff; }
  .hero-title .line2 { background: linear-gradient(135deg, var(--accent) 0%, var(--accent2) 60%, var(--accent3) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; display: block; }
  .hero-sub { font-size: 18px; color: var(--text2); max-width: 560px; line-height: 1.7; margin: 24px 0 40px; animation: fadeUp 0.6s 0.2s ease both; }
  .hero-actions { display: flex; gap: 16px; flex-wrap: wrap; animation: fadeUp 0.6s 0.3s ease both; }
  .btn-primary { background: linear-gradient(135deg, var(--accent), var(--accent2)); color: #fff; border: none; padding: 14px 32px; font-family: 'Minecraft', monospace; font-size: 15px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; border-radius: 6px; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 24px rgba(0,212,255,0.25); text-decoration: none; display: inline-block; }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 32px rgba(0,212,255,0.4); }
  .btn-outline { background: transparent; color: var(--text); border: 1px solid var(--border2); padding: 14px 32px; font-family: 'Minecraft', monospace; font-size: 15px; font-weight: 600; letter-spacing: 1.5px; text-transform: uppercase; border-radius: 6px; cursor: pointer; transition: all 0.3s; text-decoration: none; display: inline-block; }
  .btn-outline:hover { border-color: var(--accent); color: var(--accent); background: rgba(0,212,255,0.05); }
  .stats-bar { display: flex; margin-top: 80px; border: 1px solid var(--border); border-radius: 8px; overflow: hidden; animation: fadeUp 0.6s 0.4s ease both; }
  .stat-item { flex: 1; padding: 24px 28px; border-right: 1px solid var(--border); background: rgba(13,17,23,0.8); transition: background 0.2s; }
  .stat-item:last-child { border-right: none; }
  .stat-item:hover { background: rgba(0,212,255,0.04); }
  .stat-label { font-size: 11px; font-weight: 600; color: var(--text3); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 6px; }
  .stat-value { font-family: 'Minecraft', monospace; font-size: 20px; color: #fff; }
  .stat-value.green { color: var(--green); }
  .stat-value.blue { color: var(--accent); }
  .stat-value.purple { color: var(--accent2); }
  .stat-value.gold { color: var(--gold); }

  /* FEATURE CARDS */
  .features { padding: 80px 40px; max-width: 1200px; margin: 0 auto; position: relative; z-index: 3; }
  .section-header { text-align: center; margin-bottom: 56px; }
  .section-tag { font-size: 11px; font-weight: 700; color: var(--accent); letter-spacing: 3px; text-transform: uppercase; margin-bottom: 12px; }
  .section-title { font-family: 'Minecraft', monospace; font-size: 36px; font-weight: normal; color: #fff; margin-bottom: 12px; }
  .section-sub { color: var(--text2); font-size: 15px; max-width: 500px; margin: 0 auto; line-height: 1.6; }
  .features-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
  .feature-card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 0; transition: all 0.35s cubic-bezier(.25,.8,.25,1); position: relative; overflow: hidden; display: flex; flex-direction: column; }
  .feature-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, var(--card-accent, var(--accent)), transparent); opacity: 0; transition: opacity 0.3s; z-index: 2; }
  .feature-card:hover { border-color: var(--card-accent, var(--accent)); transform: translateY(-6px); box-shadow: 0 16px 48px rgba(0,0,0,0.4); }
  .feature-card:hover::before { opacity: 1; }
  .feature-img-wrap { width: 100%; height: 160px; overflow: hidden; position: relative; flex-shrink: 0; }
  .feature-img-wrap::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 60px; background: linear-gradient(transparent, var(--card)); z-index: 1; }
  .feature-img-wrap svg { width: 100%; height: 100%; display: block; }
  .feature-body { padding: 20px 24px 24px; flex: 1; }
  .feature-title { font-family: 'Minecraft', monospace; font-size: 14px; font-weight: normal; color: #fff; margin-bottom: 10px; letter-spacing: 0.5px; }
  .feature-desc { font-size: 13px; color: var(--text2); line-height: 1.65; }

  /* SOCIALS */
  .socials-section { padding: 60px 40px 100px; max-width: 1200px; margin: 0 auto; position: relative; z-index: 3; }
  .socials-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 40px; }
  .social-card { display: flex; align-items: center; gap: 16px; padding: 24px 28px; background: var(--card); border: 1px solid var(--border); border-radius: 8px; text-decoration: none; transition: all 0.3s; cursor: pointer; }
  .social-card:hover { transform: translateY(-3px); }
  .social-card.discord:hover { border-color: #5865F2; box-shadow: 0 8px 32px rgba(88,101,242,0.2); }
  .social-card.telegram:hover { border-color: #26A5E4; box-shadow: 0 8px 32px rgba(38,165,228,0.2); }
  .social-card.tiktok:hover { border-color: #ff0050; box-shadow: 0 8px 32px rgba(255,0,80,0.2); }
  .social-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; flex-shrink: 0; }
  .social-icon.discord { background: rgba(88,101,242,0.15); }
  .social-icon.telegram { background: rgba(38,165,228,0.15); }
  .social-icon.tiktok { background: rgba(255,0,80,0.1); }
  .social-info { flex: 1; }
  .social-name { font-family: 'Minecraft', monospace; font-size: 15px; color: #fff; margin-bottom: 4px; }
  .social-desc { font-size: 13px; color: var(--text2); }
  .social-arrow { color: var(--text3); font-size: 18px; }

  /* DOCS */
  #docs { display: none; min-height: 100vh; padding-top: 60px; flex-direction: column; }
  #docs.active { display: flex; }

  .docs-admin-bar { background: rgba(123,47,255,0.06); border-bottom: 1px solid rgba(123,47,255,0.2); padding: 10px 40px; display: flex; align-items: center; justify-content: space-between; gap: 12px; flex-shrink: 0; }
  .docs-layout { display: flex; flex: 1; min-height: calc(100vh - 60px); }
  .docs-sidebar { width: 260px; flex-shrink: 0; background: var(--bg2); border-right: 1px solid var(--border); padding: 32px 0; position: sticky; top: 60px; height: calc(100vh - 60px); overflow-y: auto; z-index: 10; }
  .docs-sidebar::-webkit-scrollbar { width: 4px; }
  .docs-sidebar::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 2px; }
  .sidebar-section { margin-bottom: 8px; }
  .sidebar-section-title { font-size: 10px; font-weight: 700; color: var(--text3); text-transform: uppercase; letter-spacing: 2px; padding: 8px 24px 6px; }
  .sidebar-link { display: flex; align-items: center; justify-content: space-between; padding: 7px 24px; font-size: 13px; color: var(--text2); text-decoration: none; cursor: pointer; transition: all 0.15s; border-left: 2px solid transparent; }
  .sidebar-link:hover { color: var(--text); background: rgba(255,255,255,0.03); }
  .sidebar-link.active { color: var(--accent); border-left-color: var(--accent); background: rgba(0,212,255,0.06); }
  .sidebar-link-actions { display: none; gap: 4px; }
  .sidebar-link:hover .sidebar-link-actions { display: flex; }
  .sidebar-btn { background: none; border: none; color: var(--text3); cursor: pointer; padding: 2px 4px; border-radius: 3px; font-size: 12px; transition: all 0.15s; line-height: 1; }
  .sidebar-btn:hover { color: var(--text); background: rgba(255,255,255,0.08); }
  .sidebar-btn.del:hover { color: var(--red); }

  .docs-content { flex: 1; padding: 48px 60px; max-width: 900px; overflow-y: auto; }
  .doc-section { display: none; }
  .doc-section.active { display: block; }
  .doc-section h1 { font-family: 'Minecraft', monospace; font-size: 32px; font-weight: normal; color: #fff; margin-bottom: 8px; line-height: 1.2; }
  .doc-section .doc-lead { font-size: 16px; color: var(--text2); line-height: 1.7; margin-bottom: 40px; padding-bottom: 32px; border-bottom: 1px solid var(--border); }
  .doc-section h2 { font-family: 'Minecraft', monospace; font-size: 20px; font-weight: normal; color: #fff; margin: 40px 0 16px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
  .doc-section h3 { font-size: 15px; font-weight: 700; color: var(--accent); text-transform: uppercase; letter-spacing: 1px; margin: 28px 0 12px; }
  .doc-section p { font-size: 15px; color: var(--text); line-height: 1.75; margin-bottom: 16px; }
  .doc-section ul { list-style: none; margin: 0 0 20px; }
  .doc-section ul li { font-size: 15px; color: var(--text); line-height: 1.6; padding: 5px 0 5px 20px; position: relative; }
  .doc-section ul li::before { content: '›'; position: absolute; left: 0; color: var(--accent); font-weight: 700; }

  /* ТАБЛИЦЫ */
  .doc-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px; }
  .doc-table th { background: rgba(0,212,255,0.08); color: var(--accent); font-weight: 700; font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; padding: 10px 16px; text-align: left; border-bottom: 1px solid var(--border2); border-right: 1px solid var(--border); }
  .doc-table th:last-child { border-right: none; }
  .doc-table td { padding: 10px 16px; border-bottom: 1px solid var(--border); border-right: 1px solid rgba(30,45,61,0.5); color: var(--text); vertical-align: top; }
  .doc-table td:last-child { border-right: none; }
  .doc-table tr:last-child td { border-bottom: none; }
  .doc-table tr:hover td { background: rgba(255,255,255,0.02); }
  .doc-table td:first-child { font-family: 'Minecraft', monospace; font-size: 13px; color: var(--accent2); white-space: nowrap; }
  .doc-table.striped tr:nth-child(even) td { background: rgba(0,212,255,0.025); }
  .doc-table.striped tr:nth-child(even):hover td { background: rgba(0,212,255,0.045); }

  /* INFO BOXES */
  .info-box { background: rgba(0,212,255,0.06); border: 1px solid rgba(0,212,255,0.2); border-left: 3px solid var(--accent); border-radius: 6px; padding: 14px 18px; margin: 20px 0; font-size: 14px; color: var(--text); line-height: 1.6; }
  .info-box.warning { background: rgba(240,192,64,0.06); border-color: rgba(240,192,64,0.25); border-left-color: var(--gold); }
  .info-box.danger  { background: rgba(255,68,85,0.06);  border-color: rgba(255,68,85,0.25);  border-left-color: var(--red); }
  .info-box.success { background: rgba(0,255,136,0.06); border-color: rgba(0,255,136,0.25); border-left-color: var(--green); }
  .info-box.future  { background: rgba(123,47,255,0.06); border-color: rgba(123,47,255,0.25); border-left-color: var(--accent2); }
  .info-box strong { color: var(--accent); }
  .info-box.warning strong { color: var(--gold); }
  .info-box.danger strong  { color: var(--red); }
  .info-box.success strong { color: var(--green); }
  .info-box.future strong  { color: var(--accent2); }

  /* BADGES */
  .badge { display: inline-block; padding: 2px 8px; border-radius: 3px; font-size: 11px; font-weight: 700; letter-spacing: 0.5px; text-transform: uppercase; vertical-align: middle; }
  .badge.new     { background: rgba(0,255,136,0.15); color: var(--green); }
  .badge.planned { background: rgba(123,47,255,0.15); color: var(--accent2); }
  .badge.warning { background: rgba(240,192,64,0.15); color: var(--gold); }
  .badge.danger  { background: rgba(255,68,85,0.15);  color: var(--red); }
  .badge.info    { background: rgba(0,212,255,0.12);  color: var(--accent); }
  .badge.gray    { background: rgba(255,255,255,0.06); color: var(--text3); }

  /* STAT CARDS GRID */
  .doc-stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; margin: 20px 0; }
  .doc-stat-card { background: var(--bg2); border: 1px solid var(--border); border-radius: 8px; padding: 16px 18px; text-align: center; transition: border-color 0.2s; }
  .doc-stat-card:hover { border-color: var(--border2); }
  .doc-stat-card .snum { font-family: 'Minecraft', monospace; font-size: 24px; margin-bottom: 4px; }
  .doc-stat-card .slbl { font-size: 11px; color: var(--text3); text-transform: uppercase; letter-spacing: 1px; }
  .doc-stat-card.accent { border-color: rgba(0,212,255,0.3); } .doc-stat-card.accent .snum { color: var(--accent); }
  .doc-stat-card.purple { border-color: rgba(123,47,255,0.3); } .doc-stat-card.purple .snum { color: var(--accent2); }
  .doc-stat-card.gold   { border-color: rgba(240,192,64,0.3);  } .doc-stat-card.gold .snum   { color: var(--gold); }
  .doc-stat-card.green  { border-color: rgba(0,255,136,0.3);   } .doc-stat-card.green .snum  { color: var(--green); }
  .doc-stat-card.red    { border-color: rgba(255,68,85,0.3);   } .doc-stat-card.red .snum    { color: var(--red); }

  /* ZONE GRID */
  .zone-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 20px 0; }
  .zone-card { border-radius: 6px; padding: 20px; border: 1px solid; }
  .zone-card.safe    { background: rgba(0,255,136,0.04); border-color: rgba(0,255,136,0.2); }
  .zone-card.danger  { background: rgba(255,68,85,0.04); border-color: rgba(255,68,85,0.2); }
  .zone-card.neutral { background: rgba(0,212,255,0.04); border-color: rgba(0,212,255,0.2); }
  .zone-card.warn    { background: rgba(240,192,64,0.04); border-color: rgba(240,192,64,0.2); }
  .zone-card h4 { font-family: 'Minecraft', monospace; font-size: 14px; font-weight: normal; margin-bottom: 12px; }
  .zone-card.safe h4    { color: var(--green); }
  .zone-card.danger h4  { color: var(--red); }
  .zone-card.neutral h4 { color: var(--accent); }
  .zone-card.warn h4    { color: var(--gold); }
  .zone-card ul { margin: 0; }
  .zone-card ul li { font-size: 13px; }

  /* DIVIDER */
  .doc-divider { display: flex; align-items: center; gap: 16px; margin: 36px 0 24px; color: var(--text3); font-size: 11px; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; }
  .doc-divider::before, .doc-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }

  /* 2-col text layout */
  .doc-cols-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin: 20px 0; }
  .doc-cols-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin: 20px 0; }

  /* STEPS */
  .doc-steps { display: flex; flex-direction: column; gap: 0; margin: 20px 0; }
  .doc-step { display: flex; gap: 16px; position: relative; padding-bottom: 20px; }
  .doc-step:last-child { padding-bottom: 0; }
  .doc-step:not(:last-child)::after { content: ''; position: absolute; left: 13px; top: 32px; bottom: 0; width: 1px; background: var(--border); }
  .doc-step-num { width: 28px; height: 28px; border-radius: 50%; background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.3); display: flex; align-items: center; justify-content: center; font-family: 'Minecraft', monospace; font-size: 12px; color: var(--accent); flex-shrink: 0; margin-top: 2px; }
  .doc-step-title { font-family: 'Minecraft', monospace; font-size: 13px; color: #fff; margin-bottom: 4px; }
  .doc-step-desc { font-size: 13px; color: var(--text2); line-height: 1.6; }

  /* EVENT ROWS */
  .event-grid { display: grid; gap: 8px; margin: 16px 0; }
  .event-row { display: grid; grid-template-columns: 200px 1fr 110px; border: 1px solid var(--border); border-radius: 6px; overflow: hidden; }
  .event-row .ev-name { padding: 12px 16px; background: rgba(13,17,23,0.8); font-weight: 700; font-size: 13px; color: #fff; border-right: 1px solid var(--border); }
  .event-row .ev-desc { padding: 12px 16px; font-size: 13px; color: var(--text2); border-right: 1px solid var(--border); }
  .event-row .ev-time { padding: 12px 16px; font-family: 'Minecraft', monospace; font-size: 12px; color: var(--gold); text-align: center; }

  /* QUOTE */
  .doc-quote { border-left: 3px solid var(--accent2); background: rgba(123,47,255,0.05); padding: 14px 20px; margin: 20px 0; border-radius: 0 6px 6px 0; font-size: 14px; color: var(--text2); font-style: italic; line-height: 1.7; }
  .doc-quote cite { display: block; margin-top: 8px; font-size: 12px; color: var(--text3); font-style: normal; }

  /* SPOILER */
  .doc-spoiler { margin: 12px 0; }
  .doc-spoiler summary { cursor: pointer; padding: 10px 16px; background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 6px; font-size: 13px; color: var(--text2); list-style: none; display: flex; align-items: center; gap: 8px; transition: all 0.2s; user-select: none; }
  .doc-spoiler summary::before { content: '▶'; font-size: 10px; color: var(--accent); transition: transform 0.2s; }
  .doc-spoiler[open] summary::before { transform: rotate(90deg); }
  .doc-spoiler summary:hover { background: rgba(255,255,255,0.05); color: var(--text); border-color: var(--border2); }
  .doc-spoiler-body { padding: 16px; border: 1px solid var(--border); border-top: none; border-radius: 0 0 6px 6px; background: rgba(0,0,0,0.2); }

  /* PROGRESS */
  .doc-progress-list { display: flex; flex-direction: column; gap: 10px; margin: 16px 0; }
  .doc-progress-item { display: flex; flex-direction: column; gap: 4px; }
  .doc-progress-header { display: flex; justify-content: space-between; font-size: 12px; color: var(--text2); }
  .doc-progress-bar { height: 6px; background: var(--bg3); border-radius: 3px; overflow: hidden; }
  .doc-progress-fill { height: 100%; border-radius: 3px; }

  code { font-family: 'Minecraft', monospace; font-size: 13px; background: rgba(0,212,255,0.08); color: var(--accent); padding: 2px 7px; border-radius: 3px; }

  /* GUIDE CODE BLOCK */
  .guide-codeblock { background: rgba(0,0,0,0.4); border: 1px solid var(--border2); border-left: 3px solid var(--accent2); border-radius: 6px; padding: 14px 18px; margin: 12px 0; font-family: 'Courier New', monospace; font-size: 12px; color: #b8d4e8; line-height: 1.8; white-space: pre; overflow-x: auto; }
  .guide-preview { background: rgba(0,212,255,0.03); border: 1px solid rgba(0,212,255,0.15); border-radius: 6px; padding: 14px 18px; margin: 8px 0 20px; }
  .guide-preview-label { font-size: 10px; font-weight: 700; color: var(--text3); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 10px; }

  /* doc section admin actions */
  .doc-section-actions { display: flex; gap: 8px; margin-top: 48px; padding-top: 20px; border-top: 1px solid var(--border); }

  /* EDITOR modal */
  .format-toolbar { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 8px; }
  .fmt-btn { background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: var(--text2); padding: 4px 8px; border-radius: 4px; cursor: pointer; font-family: 'Minecraft', monospace; font-size: 11px; transition: all 0.15s; white-space: nowrap; }
  .fmt-btn:hover { background: rgba(0,212,255,0.1); border-color: var(--accent); color: var(--accent); }
  .fmt-hint { background: rgba(0,0,0,0.3); border: 1px solid var(--border); border-radius: 6px; padding: 10px 12px; margin-top: 8px; font-size: 11px; color: var(--text3); line-height: 1.9; }
  .fmt-hint code { font-size: 10px; padding: 1px 4px; }

  /* NEWS */
  #news { display: none; min-height: 100vh; padding-top: 60px; }
  #news.active { display: block; }
  .news-header { padding: 60px 40px 40px; max-width: 1100px; margin: 0 auto; border-bottom: 1px solid var(--border); }
  .news-header h1 { font-family: 'Minecraft', monospace; font-size: 40px; font-weight: normal; color: #fff; margin-bottom: 8px; }
  .news-header p { color: var(--text2); font-size: 15px; }
  .news-container { max-width: 1100px; margin: 0 auto; padding: 40px; display: grid; grid-template-columns: 1fr 340px; gap: 40px; align-items: start; }
  .news-list { display: flex; flex-direction: column; gap: 16px; }
  .news-card { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 28px; transition: all 0.25s; position: relative; overflow: hidden; }
  .news-card::after { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; }
  .news-card.type-update::after { background: var(--accent); }
  .news-card.type-event::after { background: var(--gold); }
  .news-card.type-announce::after { background: var(--accent2); }
  .news-card.type-fix::after { background: var(--green); }
  .news-card.type-info::after { background: var(--text2); }
  .news-card:hover { border-color: var(--border2); transform: translateX(4px); }
  .news-meta { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
  .news-type { font-size: 10px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; padding: 3px 8px; border-radius: 3px; }
  .type-update .news-type  { background: rgba(0,212,255,0.1);   color: var(--accent); }
  .type-event .news-type   { background: rgba(240,192,64,0.1);  color: var(--gold); }
  .type-announce .news-type{ background: rgba(123,47,255,0.1);  color: var(--accent2); }
  .type-fix .news-type     { background: rgba(0,255,136,0.1);   color: var(--green); }
  .type-info .news-type    { background: rgba(200,216,232,0.1); color: var(--text2); }
  .news-date { font-family: 'Minecraft', monospace; font-size: 12px; color: var(--text3); }
  .news-card h2 { font-family: 'Minecraft', monospace; font-size: 18px; font-weight: normal; color: #fff; margin-bottom: 10px; line-height: 1.3; }
  .news-card p { font-size: 14px; color: var(--text2); line-height: 1.65; margin-bottom: 16px; }
  .news-tags { display: flex; gap: 8px; flex-wrap: wrap; }
  .news-tag { font-size: 11px; color: var(--text3); background: rgba(255,255,255,0.04); border: 1px solid var(--border); padding: 3px 10px; border-radius: 20px; }
  .news-sidebar { display: flex; flex-direction: column; gap: 20px; }
  .sidebar-widget { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 24px; }
  .widget-title { font-family: 'Minecraft', monospace; font-size: 14px; font-weight: normal; color: #fff; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--border); }
  .server-status { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
  .status-indicator { display: flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 600; }
  .status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--green); animation: pulse 2s infinite; }
  .status-dot.offline { background: var(--red); animation: none; }
  .status-dot.loading { background: var(--gold); animation: pulse 1s infinite; }
  .players-online { font-family: 'Minecraft', monospace; font-size: 24px; color: var(--green); font-weight: bold; margin: 8px 0 4px; }
  .players-label { font-size: 11px; color: var(--text3); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 10px; }
  .players-max { font-size: 11px; color: var(--text3); }
  .server-ip { font-family: 'Minecraft', monospace; font-size: 13px; color: var(--accent); background: rgba(0,212,255,0.06); border: 1px solid rgba(0,212,255,0.15); padding: 8px 12px; border-radius: 4px; text-align: center; cursor: pointer; transition: all 0.2s; margin-top: 8px; }
  .server-ip:hover { background: rgba(0,212,255,0.12); }
  .version-tag { font-family: 'Minecraft', monospace; font-size: 12px; color: var(--text3); background: rgba(255,255,255,0.04); padding: 3px 8px; border-radius: 3px; }
  .changelog-list { display: flex; flex-direction: column; gap: 10px; }
  .changelog-item { display: flex; align-items: flex-start; gap: 10px; font-size: 13px; }
  .changelog-version { font-family: 'Minecraft', monospace; font-size: 11px; color: var(--accent2); background: rgba(123,47,255,0.1); padding: 2px 6px; border-radius: 3px; white-space: nowrap; margin-top: 2px; }
  .changelog-text { color: var(--text2); line-height: 1.5; }

  /* ADMIN */
  .admin-fab { position: fixed; bottom: 28px; right: 28px; width: 44px; height: 44px; background: rgba(123,47,255,0.15); border: 1px solid rgba(123,47,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 500; transition: all 0.2s; font-size: 18px; color: var(--accent2); }
  .admin-fab:hover { background: rgba(123,47,255,0.25); border-color: var(--accent2); }
  .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(6px); z-index: 2000; align-items: center; justify-content: center; }
  .modal-overlay.open { display: flex; }
  .modal-box { background: var(--bg2); border: 1px solid var(--border2); border-radius: 10px; padding: 32px; width: 100%; max-width: 640px; position: relative; max-height: 90vh; overflow-y: auto; }
  .modal-title { font-family: 'Minecraft', monospace; font-size: 20px; color: #fff; margin-bottom: 24px; display: flex; align-items: center; gap: 10px; }
  .modal-close { position: absolute; top: 16px; right: 16px; background: none; border: none; color: var(--text3); font-size: 20px; cursor: pointer; padding: 4px 8px; border-radius: 4px; transition: all 0.15s; }
  .modal-close:hover { color: #fff; background: rgba(255,255,255,0.06); }
  .form-group { margin-bottom: 16px; }
  .form-label { display: block; font-size: 11px; font-weight: 700; color: var(--text3); text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 6px; }
  .form-input, .form-textarea, .form-select { width: 100%; background: var(--bg3); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-family: 'Minecraft', monospace; font-size: 13px; padding: 10px 14px; transition: border-color 0.2s; outline: none; }
  .form-input:focus, .form-textarea:focus, .form-select:focus { border-color: var(--accent); }
  .form-textarea { resize: vertical; min-height: 260px; font-family: 'Courier New', monospace; font-size: 12px; line-height: 1.6; white-space: pre; }
  .form-select { cursor: pointer; }
  .form-tags-input { width: 100%; background: var(--bg3); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-family: 'Minecraft', monospace; font-size: 14px; padding: 10px 14px; outline: none; transition: border-color 0.2s; }
  .form-tags-input:focus { border-color: var(--accent); }
  .btn-submit { background: linear-gradient(135deg, var(--accent2), var(--accent)); color: #fff; border: none; padding: 12px 28px; font-family: 'Minecraft', monospace; font-size: 14px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; border-radius: 6px; cursor: pointer; transition: all 0.2s; width: 100%; margin-top: 8px; }
  .btn-submit:hover { opacity: 0.9; transform: translateY(-1px); }
  .btn-danger { background: rgba(255,68,85,0.12); color: var(--red); border: 1px solid rgba(255,68,85,0.3); padding: 6px 14px; font-family: 'Minecraft', monospace; font-size: 12px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; border-radius: 4px; cursor: pointer; transition: all 0.2s; }
  .btn-danger:hover { background: rgba(255,68,85,0.22); }
  .btn-edit { background: rgba(0,212,255,0.08); color: var(--accent); border: 1px solid rgba(0,212,255,0.2); padding: 6px 14px; font-family: 'Minecraft', monospace; font-size: 12px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; border-radius: 4px; cursor: pointer; transition: all 0.2s; }
  .btn-edit:hover { background: rgba(0,212,255,0.15); }
  .news-actions { display: flex; gap: 8px; margin-top: 14px; padding-top: 14px; border-top: 1px solid var(--border); }
  .admin-bar { background: rgba(123,47,255,0.06); border-bottom: 1px solid rgba(123,47,255,0.2); padding: 10px 40px; display: flex; align-items: center; justify-content: space-between; gap: 12px; }
  .admin-bar-text { font-size: 12px; color: var(--accent2); font-weight: 600; letter-spacing: 1px; }
  .btn-add-news { background: rgba(123,47,255,0.15); color: var(--accent2); border: 1px solid rgba(123,47,255,0.35); padding: 7px 18px; font-family: 'Minecraft', monospace; font-size: 13px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; border-radius: 5px; cursor: pointer; transition: all 0.2s; }
  .btn-add-news:hover { background: rgba(123,47,255,0.25); }
  .btn-logout { background: none; color: var(--text3); border: 1px solid var(--border); padding: 7px 14px; font-family: 'Minecraft', monospace; font-size: 12px; letter-spacing: 1px; border-radius: 5px; cursor: pointer; transition: all 0.2s; }
  .btn-logout:hover { color: var(--red); border-color: rgba(255,68,85,0.3); }

  @keyframes fadeUp { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--text3); }
</style>
</head>
<body>

<nav>
  <div class="nav-logo" onclick="showPage('home')">Bliss<span>Full</span>Reloaded</div>
  <div class="nav-links">
    <a onclick="showPage('home')" id="nav-home" class="active">Главная</a>
    <a onclick="showPage('docs')" id="nav-docs">Документация</a>
    <a onclick="showPage('news')" id="nav-news">Новости</a>
  </div>
  <div class="nav-ip" onclick="copyIP()">blissfull.mc-server.net:25816</div>
</nav>
<div class="copy-toast" id="copyToast">✓ IP скопирован!</div>

<!-- ══════════════════════ ГЛАВНАЯ ══════════════════════ -->
<div id="home" class="page active">
  <div class="hero-bg"></div>
  <div class="hero-grid"></div>
  <div class="hero-content">
    <div class="hero-badge">Сервер онлайн</div>
    <div class="hero-title">
      <span class="line1">Vanilla+</span>
      <span class="line2">BlissFullReloaded</span>
    </div>
    <p class="hero-sub">Кооперативное выживание с живой экономикой, системой власти и расширяющимся миром. Каждая смерть имеет цену.</p>
    <div class="hero-actions">
      <a class="btn-primary" onclick="showPage('docs')">Документация</a>
      <a class="btn-outline" onclick="showPage('news')">Новости</a>
    </div>
    <div class="stats-bar">
      <div class="stat-item"><div class="stat-label">Версия</div><div class="stat-value blue" id="hero-version">1.21.x</div></div>
      <div class="stat-item"><div class="stat-label">Режим</div><div class="stat-value">Vanilla+</div></div>
      <div class="stat-item"><div class="stat-label">Игроков онлайн</div><div class="stat-value green" id="hero-players">—</div></div>
      <div class="stat-item"><div class="stat-label">Статус</div><div class="stat-value green" id="hero-status">Проверка...</div></div>
    </div>
  </div>

  <div class="features">
    <div class="section-header">
      <div class="section-tag">Механики</div>
      <div class="section-title">Чем живёт сервер</div>
      <div class="section-sub">Уникальные механики, которые заставляют игроков работать вместе</div>
    </div>
    <div class="features-grid">
      <div class="feature-card" style="--card-accent:#00d4ff">
        <div class="feature-img-wrap"><svg viewBox="0 0 400 160" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice"><defs><radialGradient id="bg1" cx="50%" cy="50%" r="70%"><stop offset="0%" stop-color="#0a1628"/><stop offset="100%" stop-color="#080c10"/></radialGradient><radialGradient id="glow1" cx="50%" cy="50%" r="50%"><stop offset="0%" stop-color="#00d4ff" stop-opacity="0.2"/><stop offset="100%" stop-color="#00d4ff" stop-opacity="0"/></radialGradient></defs><rect width="400" height="160" fill="url(#bg1)"/><rect width="400" height="160" fill="url(#glow1)"/><g stroke="#00d4ff" stroke-opacity="0.08" stroke-width="1"><line x1="0" y1="20" x2="400" y2="20"/><line x1="0" y1="40" x2="400" y2="40"/><line x1="0" y1="60" x2="400" y2="60"/><line x1="0" y1="80" x2="400" y2="80"/><line x1="0" y1="100" x2="400" y2="100"/><line x1="0" y1="120" x2="400" y2="120"/><line x1="0" y1="140" x2="400" y2="140"/><line x1="40" y1="0" x2="40" y2="160"/><line x1="80" y1="0" x2="80" y2="160"/><line x1="120" y1="0" x2="120" y2="160"/><line x1="160" y1="0" x2="160" y2="160"/><line x1="200" y1="0" x2="200" y2="160"/><line x1="240" y1="0" x2="240" y2="160"/><line x1="280" y1="0" x2="280" y2="160"/><line x1="320" y1="0" x2="320" y2="160"/><line x1="360" y1="0" x2="360" y2="160"/></g><circle cx="200" cy="80" r="55" fill="none" stroke="#00d4ff" stroke-width="1.5" stroke-opacity="0.6" stroke-dasharray="4 3"/><circle cx="200" cy="80" r="40" fill="none" stroke="#00d4ff" stroke-width="0.8" stroke-opacity="0.3" stroke-dasharray="2 4"/><g fill="#00d4ff" fill-opacity="0.9"><rect x="192" y="64" width="4" height="4"/><rect x="196" y="64" width="4" height="4"/><rect x="200" y="64" width="4" height="4"/><rect x="204" y="64" width="4" height="4"/><rect x="188" y="68" width="4" height="4"/><rect x="192" y="68" width="4" height="4"/><rect x="200" y="68" width="4" height="4"/><rect x="208" y="68" width="4" height="4"/><rect x="188" y="72" width="4" height="4"/><rect x="196" y="72" width="4" height="4"/><rect x="204" y="72" width="4" height="4"/><rect x="208" y="72" width="4" height="4"/><rect x="188" y="76" width="4" height="4"/><rect x="208" y="76" width="4" height="4"/><rect x="188" y="80" width="4" height="4"/><rect x="192" y="80" width="4" height="4"/><rect x="204" y="80" width="4" height="4"/><rect x="208" y="80" width="4" height="4"/><rect x="188" y="84" width="4" height="4"/><rect x="196" y="84" width="4" height="4"/><rect x="200" y="84" width="4" height="4"/><rect x="208" y="84" width="4" height="4"/><rect x="192" y="88" width="4" height="4"/><rect x="200" y="88" width="4" height="4"/><rect x="204" y="88" width="4" height="4"/><rect x="196" y="92" width="4" height="4"/><rect x="200" y="92" width="4" height="4"/></g><circle cx="200" cy="25" r="3" fill="#00d4ff" fill-opacity="0.8"/><circle cx="255" cy="80" r="2.5" fill="#00d4ff" fill-opacity="0.6"/><circle cx="145" cy="80" r="2.5" fill="#00d4ff" fill-opacity="0.6"/><circle cx="200" cy="135" r="3" fill="#00d4ff" fill-opacity="0.8"/></svg></div>
        <div class="feature-body"><div class="feature-title">Всемирный барьер</div><div class="feature-desc">Размер мира зависит от общего опыта всех игроков. Каждая смерть сужает барьер для всех.</div></div>
      </div>
      <div class="feature-card" style="--card-accent:#7b2fff">
        <div class="feature-img-wrap"><svg viewBox="0 0 400 160" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice"><defs><radialGradient id="bg2" cx="50%" cy="100%" r="80%"><stop offset="0%" stop-color="#120a1e"/><stop offset="100%" stop-color="#080c10"/></radialGradient><radialGradient id="glow2" cx="50%" cy="80%" r="40%"><stop offset="0%" stop-color="#7b2fff" stop-opacity="0.25"/><stop offset="100%" stop-color="#7b2fff" stop-opacity="0"/></radialGradient></defs><rect width="400" height="160" fill="url(#bg2)"/><rect width="400" height="160" fill="url(#glow2)"/><rect x="0" y="128" width="400" height="32" fill="#1a1228" fill-opacity="0.7"/><rect x="172" y="56" width="56" height="72" fill="#1e1530" stroke="#7b2fff" stroke-width="1" stroke-opacity="0.5"/><rect x="176" y="44" width="48" height="16" fill="#261a3a" stroke="#7b2fff" stroke-width="1" stroke-opacity="0.4"/><rect x="186" y="32" width="28" height="14" fill="#2c1e40" stroke="#7b2fff" stroke-width="0.8" stroke-opacity="0.4"/><rect x="194" y="20" width="12" height="14" fill="#7b2fff" fill-opacity="0.7"/><rect x="192" y="108" width="16" height="20" fill="#7b2fff" fill-opacity="0.4"/><rect x="108" y="80" width="48" height="48" fill="#160f24" stroke="#7b2fff" stroke-width="0.8" stroke-opacity="0.35"/><rect x="122" y="58" width="20" height="12" fill="#7b2fff" fill-opacity="0.4"/><rect x="244" y="76" width="48" height="52" fill="#160f24" stroke="#7b2fff" stroke-width="0.8" stroke-opacity="0.35"/><rect x="258" y="52" width="20" height="14" fill="#7b2fff" fill-opacity="0.5"/></svg></div>
        <div class="feature-body"><div class="feature-title">Столица и власть</div><div class="feature-desc">Мэр, Судья, Следователь, Охрана. Живая политическая система внутри игры.</div></div>
      </div>
      <div class="feature-card" style="--card-accent:#ff6b35">
        <div class="feature-img-wrap"><svg viewBox="0 0 400 160" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice"><defs><radialGradient id="bg3" cx="50%" cy="50%" r="70%"><stop offset="0%" stop-color="#1a0808"/><stop offset="100%" stop-color="#080c10"/></radialGradient></defs><rect width="400" height="160" fill="url(#bg3)"/><g fill="#ff4455"><rect x="195" y="58" width="4" height="4" fill-opacity="0.9"/><rect x="203" y="54" width="4" height="4" fill-opacity="0.7"/><rect x="199" y="46" width="4" height="4" fill-opacity="0.4"/><rect x="207" y="62" width="4" height="4" fill-opacity="0.6"/></g></svg></div>
        <div class="feature-body"><div class="feature-title">Полное ПВП</div><div class="feature-desc">За пределами Столицы — дикие земли. Рейды, убийства, захват территорий.</div></div>
      </div>
      <div class="feature-card" style="--card-accent:#f0c040">
        <div class="feature-img-wrap"><svg viewBox="0 0 400 160" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice"><defs><radialGradient id="bg4" cx="50%" cy="50%" r="70%"><stop offset="0%" stop-color="#141008"/><stop offset="100%" stop-color="#080c10"/></radialGradient></defs><rect width="400" height="160" fill="url(#bg4)"/><g fill="#f0c040" fill-opacity="0.7"><rect x="190" y="60" width="20" height="20" rx="2"/><rect x="170" y="75" width="15" height="15" rx="2" fill-opacity="0.4"/><rect x="215" y="72" width="15" height="15" rx="2" fill-opacity="0.5"/></g></svg></div>
        <div class="feature-body"><div class="feature-title">Живая экономика</div><div class="feature-desc">Умные бочки-магазины, доска найма, торги между игроками, тендеры от Мэра.</div></div>
      </div>
      <div class="feature-card" style="--card-accent:#00ff88">
        <div class="feature-img-wrap"><svg viewBox="0 0 400 160" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice"><defs><radialGradient id="bg5" cx="50%" cy="50%" r="70%"><stop offset="0%" stop-color="#0a1410"/><stop offset="100%" stop-color="#080c10"/></radialGradient></defs><rect width="400" height="160" fill="url(#bg5)"/><circle cx="200" cy="70" r="24" fill="#f0c040" fill-opacity="0.7"/><rect x="60" y="118" width="280" height="8" fill="#1a2a1a" rx="2"/><rect x="60" y="118" width="196" height="8" fill="#00ff88" fill-opacity="0.6" rx="2"/></svg></div>
        <div class="feature-body"><div class="feature-title">Система ивентов</div><div class="feature-desc">Золотая Лихорадка, Коллапс, Жертвоприношение — мир живёт и меняется в реальном времени.</div></div>
      </div>
      <div class="feature-card" style="--card-accent:#ff4455">
        <div class="feature-img-wrap"><svg viewBox="0 0 400 160" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice"><defs><radialGradient id="bg6" cx="50%" cy="50%" r="70%"><stop offset="0%" stop-color="#0e0810"/><stop offset="100%" stop-color="#080c10"/></radialGradient></defs><rect width="400" height="160" fill="url(#bg6)"/><line x1="200" y1="0" x2="200" y2="160" stroke="#4a3060" stroke-width="1" stroke-opacity="0.5" stroke-dasharray="3 4"/><rect x="188" y="62" width="24" height="24" fill="#1a0f20" stroke="#7b2fff" stroke-width="1" stroke-opacity="0.6" rx="2"/><text x="192" y="79" font-size="13" fill="#7b2fff" fill-opacity="0.9" font-family="monospace" font-weight="bold">VS</text></svg></div>
        <div class="feature-body"><div class="feature-title">Войны фракций</div><div class="feature-desc">Стройте города, создавайте союзы, объявляйте войны. Политика внутри Minecraft.</div></div>
      </div>
    </div>
  </div>

  <div class="socials-section">
    <div class="section-header">
      <div class="section-tag">Сообщество</div>
      <div class="section-title">Присоединяйся</div>
    </div>
    <div class="socials-grid">
      <a href="https://discord.gg/MY32B5hn3q" target="_blank" class="social-card discord">
        <div class="social-icon discord"><svg width="24" height="24" viewBox="0 0 24 24" fill="#5865F2"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057.1 18.08.112 18.1.132 18.11c2.053 1.508 4.041 2.423 5.993 3.03a.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028c1.961-.607 3.95-1.522 6.002-3.03a.077.077 0 0 0 .032-.027c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03z"/></svg></div>
        <div class="social-info"><div class="social-name">Discord</div><div class="social-desc">Основное сообщество</div></div>
        <div class="social-arrow">›</div>
      </a>
      <a href="https://t.me/BlissFullReloaded" target="_blank" class="social-card telegram">
        <div class="social-icon telegram"><svg width="24" height="24" viewBox="0 0 24 24" fill="#26A5E4"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg></div>
        <div class="social-info"><div class="social-name">Telegram</div><div class="social-desc">Новости и обновления</div></div>
        <div class="social-arrow">›</div>
      </a>
      <a href="https://www.tiktok.com/@jayrest29" target="_blank" class="social-card tiktok">
        <div class="social-icon tiktok"><svg width="24" height="18" viewBox="0 0 24 24" fill="#fff"><path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-2.88 2.5 2.89 2.89 0 01-2.89-2.89 2.89 2.89 0 012.89-2.89c.28 0 .54.04.79.1V9.01a6.27 6.27 0 00-.79-.05 6.34 6.34 0 00-6.34 6.34 6.34 6.34 0 006.34 6.34 6.34 6.34 0 006.33-6.34V8.69a8.18 8.18 0 004.78 1.52V6.75a4.85 4.85 0 01-1.01-.06z"/></svg></div>
        <div class="social-info"><div class="social-name">TikTok</div><div class="social-desc">Видео с сервера</div></div>
        <div class="social-arrow">›</div>
      </a>
    </div>
  </div>
</div>

<!-- ══════════════════════ ДОКУМЕНТАЦИЯ ══════════════════════ -->
<div id="docs" class="page">
  <div class="docs-admin-bar" id="docsAdminBar" style="display:none">
    <div class="admin-bar-text">⚙️ Режим редактирования документации</div>
    <div style="display:flex;gap:8px">
      <button class="btn-add-news" onclick="openAddDoc()">+ Добавить раздел</button>
    </div>
  </div>
  <div class="docs-layout">
    <aside class="docs-sidebar" id="docsSidebar"></aside>
    <div class="docs-content" id="docsContent"></div>
  </div>
</div>

<!-- ══════════════════════ НОВОСТИ ══════════════════════ -->
<div id="news" class="page">
  <div class="news-header">
    <h1>Новости и обновления</h1>
    <p>Следи за развитием сервера — новые механики, события и анонсы</p>
  </div>
  <div class="admin-bar" id="adminBar" style="display:none">
    <div class="admin-bar-text">⚙️ Режим администратора</div>
    <div style="display:flex;gap:8px">
      <button class="btn-add-news" onclick="openAddNews()">+ Добавить новость</button>
      <button class="btn-logout" onclick="adminLogout()">Выйти</button>
    </div>
  </div>
  <div class="news-container">
    <div class="news-list" id="newsList"></div>
    <div class="news-sidebar">
      <div class="sidebar-widget">
        <div class="widget-title">Статус сервера</div>
        <div class="server-status">
          <div class="status-indicator"><div class="status-dot loading" id="sidebar-dot"></div><span id="sidebar-status-text">Проверка...</span></div>
          <div class="version-tag" id="sidebar-version">1.21.x</div>
        </div>
        <div style="margin:8px 0 4px">
          <div class="players-online" id="sidebar-players">—</div>
          <div class="players-label">игроков в сети <span class="players-max" id="sidebar-max"></span></div>
        </div>
        <div class="server-ip" onclick="copyIP()">blissfull.mc-server.net:25816</div>
      </div>
      <div class="sidebar-widget">
        <div class="widget-title">Последние изменения</div>
        <div class="changelog-list">
          <div class="changelog-item"><div class="changelog-version">v1.7</div><div class="changelog-text">SmartBarrel — уникальный режим магазина</div></div>
          <div class="changelog-item"><div class="changelog-version">v2.0</div><div class="changelog-text">EternalBorder — стабильный релиз</div></div>
          <div class="changelog-item"><div class="changelog-version">v1.2</div><div class="changelog-text">TradeExperience — интеграция с EternalBorder</div></div>
          <div class="changelog-item"><div class="changelog-version">v1.5</div><div class="changelog-text">SmartBarrel — защита от взрывов</div></div>
        </div>
      </div>
      <div class="sidebar-widget">
        <div class="widget-title">Сообщество</div>
        <div style="display:flex;flex-direction:column;gap:10px">
          <a href="https://discord.gg/MY32B5hn3q" target="_blank" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text2);font-size:13px;padding:10px;background:rgba(88,101,242,0.08);border:1px solid rgba(88,101,242,0.2);border-radius:6px;transition:all 0.2s" onmouseover="this.style.background='rgba(88,101,242,0.15)'" onmouseout="this.style.background='rgba(88,101,242,0.08)'"><span style="font-size:18px">💬</span> Discord сервер</a>
          <a href="https://t.me/BlissFullReloaded" target="_blank" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text2);font-size:13px;padding:10px;background:rgba(38,165,228,0.08);border:1px solid rgba(38,165,228,0.2);border-radius:6px;transition:all 0.2s" onmouseover="this.style.background='rgba(38,165,228,0.15)'" onmouseout="this.style.background='rgba(38,165,228,0.08)'"><span style="font-size:18px">✈️</span> Telegram канал</a>
          <a href="https://www.tiktok.com/@jayrest29" target="_blank" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text2);font-size:13px;padding:10px;background:rgba(255,0,80,0.06);border:1px solid rgba(255,0,80,0.15);border-radius:6px;transition:all 0.2s" onmouseover="this.style.background='rgba(255,0,80,0.12)'" onmouseout="this.style.background='rgba(255,0,80,0.06)'"><span style="font-size:18px">🎵</span> TikTok</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MODALS -->
<button class="admin-fab" onclick="openAdminLogin()" title="Войти как администратор">⚙️</button>

<div class="modal-overlay" id="adminLoginModal">
  <div class="modal-box" style="max-width:380px">
    <div class="modal-title">🔒 Вход для администратора</div>
    <button class="modal-close" onclick="closeAdminLogin()">✕</button>
    <div class="form-group">
      <label class="form-label">Пароль</label>
      <input type="password" class="form-input" id="adminPassInput" placeholder="Введите пароль" onkeydown="if(event.key==='Enter')doAdminLogin()">
    </div>
    <div id="adminLoginError" style="display:none;color:var(--red);font-size:13px;margin-bottom:12px;">Неверный пароль</div>
    <button class="btn-submit" onclick="doAdminLogin()">Войти</button>
  </div>
</div>

<div class="modal-overlay" id="newsModal">
  <div class="modal-box">
    <div class="modal-title" id="newsFormTitle">➕ Добавить новость</div>
    <button class="modal-close" onclick="closeNewsModal()">✕</button>
    <div class="form-group">
      <label class="form-label">Тип</label>
      <select class="form-select" id="newsFormType">
        <option value="update">Обновление</option>
        <option value="announce">Анонс</option>
        <option value="event">Событие</option>
        <option value="fix">Фикс</option>
        <option value="info">Инфо</option>
      </select>
    </div>
    <div class="form-group">
      <label class="form-label">Дата (например, 23.02.2026)</label>
      <input type="text" class="form-input" id="newsFormDate" placeholder="ДД.ММ.ГГГГ">
    </div>
    <div class="form-group">
      <label class="form-label">Заголовок</label>
      <input type="text" class="form-input" id="newsFormTitle2" placeholder="Название новости">
    </div>
    <div class="form-group">
      <label class="form-label">Текст</label>
      <textarea class="form-textarea" style="min-height:100px;font-family:'Minecraft',monospace;font-size:13px" id="newsFormText" placeholder="Описание обновления..."></textarea>
    </div>
    <div class="form-group">
      <label class="form-label">Теги (через запятую)</label>
      <input type="text" class="form-tags-input" id="newsFormTags" placeholder="Тег1, Тег2, Тег3">
    </div>
    <button class="btn-submit" onclick="saveNewsForm()">💾 Сохранить</button>
  </div>
</div>

<div class="modal-overlay" id="docModal">
  <div class="modal-box" style="max-width:700px">
    <div class="modal-title" id="docFormTitle">➕ Новый раздел</div>
    <button class="modal-close" onclick="closeDocModal()">✕</button>
    <div class="form-group">
      <label class="form-label">Категория (в сайдбаре)</label>
      <input type="text" class="form-input" id="docFormCat" placeholder="Например: Мир, Общество, Справочник">
    </div>
    <div class="form-group">
      <label class="form-label">Заголовок раздела</label>
      <input type="text" class="form-input" id="docFormHeading" placeholder="Например: Всемирный барьер">
    </div>
    <div class="form-group">
      <label class="form-label">Краткое описание (под заголовком)</label>
      <input type="text" class="form-input" id="docFormLead" placeholder="Одно-два предложения о разделе">
    </div>
    <div class="form-group">
      <label class="form-label">Содержимое <span style="color:var(--text3);font-weight:normal;text-transform:none;letter-spacing:0">(разметка ниже)</span></label>
      <div class="format-toolbar" id="fmtToolbar">
        <button class="fmt-btn" onclick="ins('## Заголовок\n')">## H2</button>
        <button class="fmt-btn" onclick="ins('### Подзаголовок\n')">### H3</button>
        <button class="fmt-btn" onclick="ins('[divider]Текст разделителя[/divider]\n')">─ divider</button>
        <button class="fmt-btn" onclick="ins('- Пункт списка\n')">— list</button>
        <button class="fmt-btn" onclick="ins('[box]Текст[/box]\n')">[box]</button>
        <button class="fmt-btn" onclick="ins('[box warning][b]Внимание:[/b] текст[/box]\n')">[!warning]</button>
        <button class="fmt-btn" onclick="ins('[box danger][b]Опасно:[/b] текст[/box]\n')">[!danger]</button>
        <button class="fmt-btn" onclick="ins('[box success][b]Успех:[/b] текст[/box]\n')">[!success]</button>
        <button class="fmt-btn" onclick="ins('[box future][b]Планируется:[/b] текст[/box]\n')">[!future]</button>
        <button class="fmt-btn" onclick="ins('[badge info]Текст[/badge]')">[badge]</button>
        <button class="fmt-btn" onclick="ins('[table]\n[th]Кол.1[/th][th]Кол.2[/th][th]Кол.3[/th]\n[td]Данные[/td][td]Данные[/td][td]Данные[/td]\n[/table]\n')">table</button>
        <button class="fmt-btn" onclick="ins('[table striped]\n[th]Кол.1[/th][th]Кол.2[/th][th]Статус[/th]\n[td]Данные[/td][td]Данные[/td][td][badge new]Активно[/badge][/td]\n[/table]\n')">table+stripe</button>
        <button class="fmt-btn" onclick="ins('[zones]\n[zone safe]✔ Плюсы\n- Пункт\n[/zone]\n[zone danger]✖ Минусы\n- Пункт\n[/zone]\n[/zones]\n')">zones</button>
        <button class="fmt-btn" onclick="ins('[stats]\n[stat accent]42[/stat][statlbl]Описание[/statlbl]\n[stat gold]3x[/stat][statlbl]Описание[/statlbl]\n[/stats]\n')">stats</button>
        <button class="fmt-btn" onclick="ins('[events]\n[ev]🟡 Название[/ev][evd]Описание события[/evd][evt]30 мин[/evt]\n[/events]\n')">events</button>
        <button class="fmt-btn" onclick="ins('[steps]\n[step]Шаг первый\nОписание что делать[/step]\n[step]Шаг второй\nОписание что делать[/step]\n[/steps]\n')">steps</button>
        <button class="fmt-btn" onclick="ins('[spoiler]Заголовок спойлера\nСодержимое которое скрыто\n[/spoiler]\n')">▶ spoiler</button>
        <button class="fmt-btn" onclick="ins('[progress]\n[pb]Параметр|75|green[/pb]\n[pb]Параметр|40|accent[/pb]\n[/progress]\n')">progress</button>
        <button class="fmt-btn" onclick="ins('[cols2]\n[col]Текст левой колонки\n[/col]\n[col]Текст правой колонки\n[/col]\n[/cols2]\n')">2 cols</button>
        <button class="fmt-btn" onclick="ins('[quote]Цитата или важная мысль\n[cite]Автор[/cite]\n[/quote]\n')">❝ quote</button>
        <button class="fmt-btn" onclick="ins('[b]жирный текст[/b]')">[b]</button>
        <button class="fmt-btn" onclick="ins('`код`')">`code`</button>
      </div>
      <textarea class="form-textarea" id="docFormBody" placeholder="## Заголовок раздела&#10;&#10;Текст абзаца...&#10;&#10;- Пункт списка&#10;&#10;[box]Блок информации[/box]"></textarea>
      <div class="fmt-hint">
        <strong style="color:var(--text2)">Разметка:</strong>
        <code>[box]</code> блок · <code>[box warning/danger/success/future]</code> цветной блок ·
        <code>[table][th]Кол.[/th][td]Данные[/td][/table]</code> таблица · <code>[table striped]</code> полосатая ·
        <code>[zones][zone safe/danger/neutral/warn][/zone][/zones]</code> карточки-зоны ·
        <code>[stats][stat accent/gold/green/red/purple]42[/stat][statlbl]текст[/statlbl][/stats]</code> числа ·
        <code>[events][ev][/ev][evd][/evd][evt][/evt][/events]</code> таблица ивентов ·
        <code>[steps][step]заголовок\nтекст[/step][/steps]</code> шаги ·
        <code>[spoiler]заголовок\nтело[/spoiler]</code> спойлер ·
        <code>[progress][pb]Метка|70|green[/pb][/progress]</code> прогресс ·
        <code>[cols2][col][/col][col][/col][/cols2]</code> колонки ·
        <code>[quote]текст\n[cite]автор[/cite][/quote]</code> цитата ·
        <code>[badge info/new/warning/danger/gray/planned]текст[/badge]</code> бейдж ·
        <code>[divider]текст[/divider]</code> разделитель ·
        <code>[b]жирный[/b]</code> · <code>`инлайн код`</code>
      </div>
    </div>
    <button class="btn-submit" onclick="saveDocForm()">💾 Сохранить раздел</button>
  </div>
</div>

<script>
const AUTH_URL = 'https://blissfull-production.up.railway.app/auth';
let isAdmin = false;
let editingNewsId = null;
let editingDocId = null;
let currentDocId = null;

// ══════════════════════════════════════════════════════

// ══════════════════════════════════════════════════════
// ДОКУМЕНТАЦИЯ — DEFAULT DATA
// ══════════════════════════════════════════════════════
const DEFAULT_DOCS = [
  { id:1, category:'Введение', title:'Концепция сервера',
    lead:'BlissFullReloaded — Vanilla+ сервер с упором на PvE, кооперацию, экономику и постепенное исследование мира. Все игроки начинают в одном месте — Столице.',
    body:`## Ключевые принципы

- Один стартовый город (Столица) — точка входа и центр жизни сервера
- Мир расширяется постепенно — через общий банк XP всех игроков
- В Столице — мир и закон. За её пределами — дикие земли, полное ПВП
- Кооперация выгоднее одиночной игры
- Социальные конфликты решаются через игровые органы власти
- Администрация следит за читами, не вмешивается в социальные споры

[box][b]Главная идея:[/b] каждая смерть имеет цену для всего сервера. Чем лучше выживает каждый — тем больше открытого мира для всех.[/box]

[divider]Цифры сезона[/divider]

[stats]
[stat accent]∞[/stat][statlbl]Мир без конца[/statlbl]
[stat purple]7[/stat][statlbl]Ролей власти[/statlbl]
[stat gold]3x[/stat][statlbl]Макс. множитель XP[/statlbl]
[stat green]100%[/stat][statlbl]Ванильное ядро[/statlbl]
[/stats]`},

  { id:2, category:'Мир', title:'Столица',
    lead:'Единственный город на старте сезона. Центр торговли, власти и безопасности. Все новые игроки появляются здесь.',
    body:`## Инфраструктура

[table]
[th]Объект[/th][th]Управляет[/th][th]Функция[/th]
[td]Мэрия[/td][td]Мэр[/td][td]Разрешения на стройку, тендеры, управление городом[/td]
[td]Суд[/td][td]Судья[/td][td]Разбор нарушений и конфликтов между игроками[/td]
[td]Склады[/td][td]Мэр[/td][td]Городские ресурсы и резервы для нужд города[/td]
[td]Рынок[/td][td]Все[/td][td]Бочки-магазины, доска объявлений, торговля[/td]
[td]Доска найма[/td][td]Все[/td][td]Заказы на ресурсы, охоту на мобов и игроков[/td]
[/table]

## Выбор при старте

[zones]
[zone safe]🏠 Жить в Столице
- ✔ Защита базы от рейда
- ✔ Рядом с рынком и доской найма
- ✔ В центре событий и политики
- ✖ Плата за защиту
- ✖ Строительство по правилам Мэра
[/zone]
[zone danger]🌲 Уйти в дикие земли
- ✔ Полная свобода строительства
- ✔ Нет платы за проживание
- ✖ База не защищена от рейда
- ✖ Могут убить в любой момент
- ✖ Нет гарантий безопасности
[/zone]
[/zones]

[box warning][b]Плата за защиту:[/b] игрок платит не за участок, а за защиту которую обеспечивает Столица. Размер и условия оплаты устанавливает Мэр.[/box]`},

  { id:3, category:'Мир', title:'ПВП и дикие земли',
    lead:'За пределами Столицы действуют законы дикого мира. Полное ПВП без ограничений.',
    body:`## Зоны мира

[table striped]
[th]Зона[/th][th]ПВП[/th][th]Рейд базы[/th][th]Закон[/th]
[td]Столица[/td][td][badge danger]Запрещено[/badge][/td][td][badge danger]Запрещено[/badge][/td][td]Правила Мэра + Судья[/td]
[td]Дикие земли[/td][td][badge new]Разрешено[/badge][/td][td][badge new]Разрешено[/badge][/td][td]Закон силы[/td]
[td]ПВП арены[/td][td][badge info]Добровольно[/badge][/td][td][badge gray]Н/А[/badge][/td][td]Согласие сторон[/td]
[/table]

## Правила диких земель

- Убийство игроков — разрешено без предупреждения
- Рейд базы — разрешён: можно ломать постройки, красть ресурсы
- Трофеи убитого игрока достаются победителю
- Объединение в группы для совместных рейдов — приветствуется

## Доска найма

[table]
[th]Тип заказа[/th][th]Пример[/th][th]Оплата[/th]
[td]Добыча ресурсов[/td][td]Нужно 3 стака железа[/td][td]10 бутылок опыта[/td]
[td]Охота на мобов[/td][td]Убить 20 скелетов >5000 блоков[/td][td]Алмазы[/td]
[td]Охота на игрока[/td][td]Цель: [ник][/td][td]Договорная[/td]
[td]Охрана / эскорт[/td][td]Сопровождение в опасных землях[/td][td]По договорённости[/td]
[/table]`},

  { id:4, category:'Мир', title:'Всемирный барьер',
    lead:'Центральная механика сервера. Радиус мирового барьера зависит от суммарного XP в общем банке.',
    body:`## Принцип работы

[table striped]
[th]Действие[/th][th]Эффект на банк[/th][th]Статус[/th]
[td]Получение опыта[/td][td]XP → банк → барьер расширяется[/td][td][badge new]Активно[/badge][/td]
[td]Смерть игрока[/td][td]Весь XP убитого вычитается из банка[/td][td][badge danger]Опасно[/badge][/td]
[td]Зачарование / Переименование[/td][td]Трата XP — барьер НЕ уменьшается[/td][td][badge info]Нейтрально[/badge][/td]
[td]BioMarket (органика)[/td][td]Органика → XP → банк[/td][td][badge new]Активно[/badge][/td]
[td]Умышленный суицид[/td][td]Технический бан без предупреждения[/td][td][badge danger]БАН[/badge][/td]
[/table]

## Система эпох

[steps]
[step]Начальная эпоха
Только Верхний мир. Небольшой радиус барьера — игроки держатся близко к Столице.[/step]
[step]Средние эпохи
Открывается Ад. Новые ресурсы, новые опасности и новые возможности для экономики.[/step]
[step]Поздние эпохи
Открывается Энд. Финальные боссы, порталы, эндерские острова для самых опытных.[/step]
[/steps]

[box warning][b]Важно:[/b] умышленный суицид с целью сужения барьера — технический бан без предупреждения.[/box]`},

  { id:5, category:'Мир', title:'Система ивентов',
    lead:'Ивенты запускаются автоматически и влияют на работу барьера и игровой процесс.',
    body:`## Все ивенты

[events]
[ev]🟡 Золотая Лихорадка[/ev][evd]Опыт в банке умножается на 3х[/evd][evt]35 сек[/evt]
[ev]🔴 Теневое Эмбарго[/ev][evd]XP перестаёт поступать в банк, но при смерти отнимается[/evd][evt]30 мин[/evt]
[ev]💀 Жертвоприношение[/ev][evd]За каждую смерть банк получает +500 XP[/evd][evt]60 сек[/evt]
[ev]👹 Охота на монстра[/ev][evd]Усиленный монстр рядом с рандомным игроком. Награда: 1000–2500 XP[/evd][evt]5 мин[/evt]
[ev]🌀 Нестабильность[/ev][evd]Барьер «дышит» — сужается и расширяется поочерёдно[/evd][evt]60 сек[/evt]
[ev]⚠️ Коллапс[/ev][evd]Барьер сужается 5 XP/сек. Нужно активно фармить опыт[/evd][evt]45 сек[/evt]
[ev]🏘 Деревенский Рейд[/ev][evd]Запускается если игрок в деревне >1 часа[/evd][evt]До победы[/evt]
[/events]

[box][b]Совет:[/b] во время Коллапса немедленно объединяйтесь — чем больше игроков фармит XP одновременно, тем быстрее стабилизируется барьер.[/box]`},

  { id:6, category:'Мир', title:'Механики мира',
    lead:'Уникальные правила, которые делают выживание сложнее и интереснее.',
    body:`## Динамическая сложность

[table striped]
[th]Дистанция от спавна[/th][th]Множитель HP мобов[/th][th]Пример[/th]
[td]0 – 1 000 блоков[/td][td]×1.0 (ваниль)[/td][td]Зомби: 20 HP[/td]
[td]1 000 – 3 000[/td][td]×1.25[/td][td]Зомби: 25 HP[/td]
[td]3 000 – 7 000[/td][td]×1.6[/td][td]Зомби: 32 HP[/td]
[td]10 000+[/td][td]×2.5+[/td][td]Паук: 200+ HP[/td]
[/table]

[cols2]
[col]## Клаустрофобия

Долгое пребывание под землёй вызывает дебаффы:

- Тошнота и Слепота
- Медлительность
- Слабость

При входе на сервер — шанс уже иметь фобию.
[/col]
[col]## Навигация

- F3 отключён
- Координаты — только с компасом в руке
- При наведении на игрока — ник и лицензия
- В Аду — ники и лицензии искажаются
[/col]
[/cols2]

## Прочие механики

[table]
[th]Механика[/th][th]Описание[/th][th]Статус[/th]
[td]Замедленный рост[/td][td]Зерновые, ягоды и деревья растут значительно медленнее ванили[/td][td][badge new]Активно[/badge][/td]
[td]Молнии и броня[/td][td]Гроза + медная броня = шанс удара молнией[/td][td][badge new]Активно[/badge][/td]
[td]Портал в Ад[/td][td]Минимальный размер рамки — 5×4 блока вместо 4×5[/td][td][badge new]Активно[/badge][/td]
[td]BioMarket[/td][td]Органика (пшеница, морковь, лут с мобов) → XP в банк[/td][td][badge new]Активно[/badge][/td]
[/table]`},

  { id:7, category:'Общество', title:'Лицензии и роли',
    lead:'Лицензии дают технические права и обязанности. Получить — через заявку и голосование в Discord.',
    body:`[box warning][b]Ограничения:[/b] нельзя быть Мэром и Судьёй одновременно. Отсутствие >7 суток без уведомления — лицензия аннулируется.[/box]

## Все роли

[table striped]
[th]Роль[/th][th]Технические права[/th][th]Обязанности[/th][th]Ограничение[/th]
[td]Мэр[/td][td]Разрешения на стройку в спецзонах[/td][td]Тендеры, дороги, развитие Столицы[/td][td]1 человек[/td]
[td]Судья[/td][td]Префикс [Преступник], штрафы[/td][td]Вердикты только по логам Следователя[/td][td]1 человек[/td]
[td]Следователь[/td][td]\`/co i\`, \`/co near\`[/td][td]Сбор улик, нейтралитет[/td][td]1-2 человека[/td]
[td]Охрана порядка[/td][td]\`/freeze\`, \`/unfreeze\`[/td][td]Задержание до суда[/td][td]До 3 человек[/td]
[td]Адвокат[/td][td]Доступ в зону задержания[/td][td]Помощь игрокам, аудит договоров[/td][td]Без лимита[/td]
[td]Строитель[/td][td]\`/hat\`, \`/ec\`[/td][td]Заказы Мэра, реставрация[/td][td]Без лимита[/td]
[td]Ивент-менеджер[/td][td]\`/broadcast\`[/td][td]Минимум 1 событие в 2 недели[/td][td]1-2 человека[/td]
[/table]

## Как получить роль

[steps]
[step]Подать заявку в Discord
Описать кандидатуру, опыт на сервере и мотивацию в специальном канале.[/step]
[step]Голосование игроков
В течение 48 часов действующие игроки голосуют за кандидата.[/step]
[step]Утверждение Мэром
При положительном голосовании Мэр выдаёт лицензию.[/step]
[/steps]`},

  { id:8, category:'Общество', title:'Экономика и торговля',
    lead:'Живая экономика между игроками. Умные бочки-магазины, онлайн-торги, государственные тендеры.',
    body:`## Умные бочки (SmartBarrel)

[table striped]
[th]Тип[/th][th]Товаров[/th][th]Склад[/th][th]Описание[/th]
[td]Магазин[/td][td]1[/td][td]18 слотов[/td][td]Один товар, фиксированная цена. ЛКМ ×1, ПКМ ×16, Shift ×64[/td]
[td]Бар[/td][td]Несколько[/td][td]54 слота[/td][td]Разные напитки, у каждого своя цена[/td]
[td]Уникальный[/td][td]Несколько[/td][td]54 слота[/td][td]Как бар, но для любых предметов[/td]
[/table]

[zones]
[zone neutral]📦 Тендеры от Мэра
- Официальный заказ от Мэра
- Условия фиксируются в Discord
- Победитель получает привилегии или ресурсы
[/zone]
[zone warn]⚖️ Клановые контракты
- Клан даёт право на коллективные иски
- Группа от 3 человек выбирает представителя
- Переговоры ведутся официально
[/zone]
[/zones]`},

  { id:9, category:'Общество', title:'Войны фракций',
    lead:'Система городов, фракций и межгородских конфликтов. Стройте города, создавайте союзы, объявляйте войны.',
    body:`[box future][b]⚙ Планируемая механика[/b] — будет введена при достаточном онлайне и росте Столицы.[/box]

## Новые города

[table]
[th]Параметр[/th][th]Описание[/th]
[td]Основание[/td][td]Группа игроков может основать город за пределами Столицы[/td]
[td]Управление[/td][td]Каждый город имеет своего Мэра, законы и инфраструктуру[/td]
[td]Отношения[/td][td]Союзы, торговые договоры, нейтралитет, война[/td]
[/table]

## Войны и захват

[zones]
[zone safe]☮️ Мирные отношения
- Союзы и торговые договоры
- Совместные рейды на мобов
- Дипломатические переговоры
- Нейтральный статус
[/zone]
[zone danger]⚔️ Состояние войны
- Полное ПВП между фракциями везде
- Захват структур противника
- Блокада и осада городов
- Найм наёмников через доску
[/zone]
[/zones]

[box][b]Мир заключается договором в Discord.[/b] Нейтральные игроки не затрагиваются конфликтом.[/box]`},

  { id:10, category:'Справочник', title:'Команды игрока',
    lead:'Полный справочник доступных команд для всех игроков.',
    body:`## Регистрация и вход

[table]
[th]Команда[/th][th]Описание[/th]
[td]/register[/td][td]Регистрация при первом входе на сервер[/td]
[td]/login, /l[/td][td]Авторизация при каждом входе[/td]
[td]/changepassword[/td][td]Смена пароля аккаунта[/td]
[/table]

## Чат и общение

[table striped]
[th]Команда[/th][th]Описание[/th]
[td]/msg <ник> <текст>[/td][td]Личное сообщение игроку[/td]
[td]/r <текст>[/td][td]Ответить последнему собеседнику[/td]
[td]/ignore <ник>[/td][td]Заблокировать сообщения от игрока[/td]
[td]/unignore <ник>[/td][td]Снять блокировку[/td]
[td]/me <текст>[/td][td]Ролевое действие от третьего лица[/td]
[/table]

## Анимации и позы

[table]
[th]Команда[/th][th]Действие[/th]
[td]/sit[/td][td]Сесть (или ПКМ по ступеньке)[/td]
[td]/lay[/td][td]Лечь на спину[/td]
[td]/crawl[/td][td]Ползти по-пластунски[/td]
[td]/bellyflop[/td][td]Лечь на животик[/td]
[td]/Sleeper[/td][td]Пропустить ночь голосованием[/td]
[/table]

## Сундуки и хранилища

[table]
[th]Команда[/th][th]Описание[/th]
[td]/lock[/td][td]Заблокировать свой сундук от чужих[/td]
[td]/unlock[/td][td]Открыть для общего доступа[/td]
[td]/trust <ник>[/td][td]Добавить доверенного игрока к сундуку[/td]
[/table]

## Скины и визуал

[table striped]
[th]Команда[/th][th]Описание[/th]
[td]/skin set <ник>[/td][td]Установить скин другого игрока[/td]
[td]/skin url <ссылка>[/td][td]Установить скин по URL[/td]
[td]/skin clear[/td][td]Вернуть стандартный скин Minecraft[/td]
[td]/skin update[/td][td]Обновить скин с сервера Mojang[/td]
[td]/hat[/td][td]Надеть предмет на голову [badge planned]Строители[/badge][/td]
[td]/ec, /enderchest[/td][td]Карманный эндер-сундук [badge planned]Строители[/badge][/td]
[/table]

## Алкоголь (Brewery)

[table]
[th]Команда[/th][th]Описание[/th]
[td]/brew help[/td][td]Список всех команд плагина[/td]
[td]/brew info[/td][td]Информация о напитке в руке[/td]
[td]/brew wakeup[/td][td]Принудительно выйти из опьянения[/td]
[td]/brew drain[/td][td]Слить жидкость из варочной бочки[/td]
[td]/brew create[/td][td]Создать бочку для брожения[/td]
[/table]`},

  { id:11, category:'Справочник', title:'Правила сервера',
    lead:'Незнание правил не освобождает от ответственности. Заходя на сервер — вы соглашаетесь с ними.',
    body:`[box danger][b]Важно:[/b] некоторые нарушения влекут моментальный бан без предупреждений.[/box]

## Поведение в сообществе

- Запрещены оскорбления, пропаганда насилия, экстремизм
- Спам, флуд, злоупотребление CAPS — запрещены
- Никнейм, скин, аватар Discord — без оскорблений и неприемлемого контента

## Технические нарушения → Административный бан

[table]
[th]Нарушение[/th][th]Наказание[/th]
[td]Читы: X-Ray, KillAura, Fly и любое ПО с преимуществом[/td][td][badge danger]Мгновенный бан[/badge][/td]
[td]Дюп предметов, эксплойты барьера[/td][td][badge danger]Мгновенный бан[/badge][/td]
[td]Лаг-машины и намеренная нагрузка сервера[/td][td][badge danger]Мгновенный бан[/badge][/td]
[td]Умышленный суицид для сужения барьера[/td][td][badge danger]Мгновенный бан[/badge][/td]
[/table]

## Игровые нарушения → Судебный разбор

[zones]
[zone danger]⚠️ Нарушения в Столице
- Гриферство — уничтожение чужих построек
- Кража из защищённых контейнеров
- Незаконное ПВП — убийство без согласия
[/zone]
[zone warn]📋 Порядок наказаний
- 1-е нарушение: Предупреждение
- 2-е: Мут, кик или ограничение
- 3-е и далее: Временный или перм. бан
[/zone]
[/zones]`}
];

const DOCS_VERSION = 'v3'; // Увеличь при смене DEFAULT_DOCS

function getDocs() {
  try {
    if (localStorage.getItem('bfr_docs_ver') !== DOCS_VERSION) {
      // Устаревший кэш — сбрасываем
      localStorage.removeItem('bfr_docs');
      localStorage.setItem('bfr_docs_ver', DOCS_VERSION);
      return DEFAULT_DOCS;
    }
    const d = localStorage.getItem('bfr_docs');
    return d ? JSON.parse(d) : DEFAULT_DOCS;
  } catch(e) { return DEFAULT_DOCS; }
}
function saveDocs(docs) {
  try {
    localStorage.setItem('bfr_docs', JSON.stringify(docs));
    localStorage.setItem('bfr_docs_ver', DOCS_VERSION);
  } catch(e) {}
}

// ══════════════════════════════════════════════════════
// MARKUP PARSER — ИСПРАВЛЕННАЯ ВЕРСИЯ
// Главное исправление: колонки считаются из ТЕКУЩЕЙ таблицы, не из всего документа
// ══════════════════════════════════════════════════════
function parseDocMarkup(raw) {
  if (!raw) return '';
  let s = escHtml(raw);

  // [stats]
  s = s.replace(/\[stats\]([\s\S]*?)\[\/stats\]/g, (_, inner) => {
    const cards = [];
    const re = /\[stat\s+(\w+)\](.*?)\[\/stat\]\s*\[statlbl\](.*?)\[\/statlbl\]/g;
    let m;
    while ((m = re.exec(inner)) !== null) {
      cards.push(`<div class="doc-stat-card ${m[1]}"><div class="snum">${m[2]}</div><div class="slbl">${m[3]}</div></div>`);
    }
    return `<div class="doc-stat-grid">${cards.join('')}</div>`;
  });

  // [events]
  s = s.replace(/\[events\]([\s\S]*?)\[\/events\]/g, (_, inner) => {
    const rows = [];
    const re = /\[ev\](.*?)\[\/ev\]\s*\[evd\](.*?)\[\/evd\]\s*\[evt\](.*?)\[\/evt\]/g;
    let m;
    while ((m = re.exec(inner)) !== null) {
      rows.push(`<div class="event-row"><div class="ev-name">${m[1]}</div><div class="ev-desc">${m[2]}</div><div class="ev-time">${m[3]}</div></div>`);
    }
    return `<div class="event-grid">${rows.join('')}</div>`;
  });

  // ══ ИСПРАВЛЕННЫЙ ПАРСЕР ТАБЛИЦ ══
  // Считает колонки из ЛОКАЛЬНОГО совпадения [th], а не из всего raw
  s = s.replace(/\[table(\s+\w+)?\]([\s\S]*?)\[\/table\]/g, (fullMatch, cls, inner) => {
    const extraClass = cls ? cls.trim() : '';
    let html = `<table class="doc-table${extraClass ? ' '+extraClass : ''}">`;

    // Считаем [th] только внутри ЭТОЙ таблицы
    const localThs = inner.match(/\[th\](.*?)\[\/th\]/g) || [];
    const colCount = localThs.length || 2;

    if (localThs.length > 0) {
      html += '<thead><tr>';
      localThs.forEach(t => {
        const content = t.replace(/\[th\]|\[\/th\]/g, '');
        html += `<th>${content}</th>`;
      });
      html += '</tr></thead>';
      // Убираем строку с заголовками из inner
      inner = inner.replace(/(\[th\].*?\[\/th\]\s*)+/, '');
    }

    html += '<tbody>';
    const tds = inner.match(/\[td\]([\s\S]*?)\[\/td\]/g) || [];

    for (let i = 0; i < tds.length; i += colCount) {
      html += '<tr>';
      for (let j = 0; j < colCount && (i + j) < tds.length; j++) {
        const cell = tds[i + j].replace(/^\[td\]|\[\/td\]$/g, '');
        html += `<td>${cell}</td>`;
      }
      html += '</tr>';
    }

    html += '</tbody></table>';
    return html;
  });

  // [zones]
  s = s.replace(/\[zones\]([\s\S]*?)\[\/zones\]/g, (_, inner) => {
    const zoneRe = /\[zone\s+(\w+)\]([\s\S]*?)\[\/zone\]/g;
    let cards = ''; let m;
    while ((m = zoneRe.exec(inner)) !== null) {
      const lines = m[2].trim().split('\n');
      const title = lines[0];
      const items = lines.slice(1).filter(l => l.trim().startsWith('-')).map(l => `<li>${l.replace(/^-\s*/, '')}</li>`).join('');
      cards += `<div class="zone-card ${m[1]}"><h4>${title}</h4><ul>${items}</ul></div>`;
    }
    return `<div class="zone-grid">${cards}</div>`;
  });

  // [steps]
  s = s.replace(/\[steps\]([\s\S]*?)\[\/steps\]/g, (_, inner) => {
    const stepRe = /\[step\]([\s\S]*?)\[\/step\]/g;
    let html = '<div class="doc-steps">'; let m; let n = 1;
    while ((m = stepRe.exec(inner)) !== null) {
      const lines = m[1].trim().split('\n');
      const title = lines[0];
      const desc = lines.slice(1).join(' ').trim();
      html += `<div class="doc-step"><div class="doc-step-num">${n++}</div><div><div class="doc-step-title">${title}</div>${desc ? `<div class="doc-step-desc">${desc}</div>` : ''}</div></div>`;
    }
    return html + '</div>';
  });

  // [progress]
  s = s.replace(/\[progress\]([\s\S]*?)\[\/progress\]/g, (_, inner) => {
    const pbRe = /\[pb\](.*?)\[\/pb\]/g;
    let html = '<div class="doc-progress-list">'; let m;
    while ((m = pbRe.exec(inner)) !== null) {
      const parts = m[1].split('|');
      const label = parts[0] || '';
      const pct = parseInt(parts[1] || '50');
      const color = parts[2] || 'accent';
      const colorMap = { accent: 'var(--accent)', green: 'var(--green)', gold: 'var(--gold)', red: 'var(--red)', purple: 'var(--accent2)' };
      const fill = colorMap[color] || 'var(--accent)';
      html += `<div class="doc-progress-item"><div class="doc-progress-header"><span>${label}</span><span>${pct}%</span></div><div class="doc-progress-bar"><div class="doc-progress-fill" style="width:${pct}%;background:${fill}"></div></div></div>`;
    }
    return html + '</div>';
  });

  // [cols2]
  s = s.replace(/\[cols2\]([\s\S]*?)\[\/cols2\]/g, (_, inner) => {
    const colRe = /\[col\]([\s\S]*?)\[\/col\]/g;
    let cols = []; let m;
    while ((m = colRe.exec(inner)) !== null) cols.push(`<div>${parseDocMarkup(unescHtml(m[1]))}</div>`);
    return `<div class="doc-cols-2">${cols.join('')}</div>`;
  });

  // [spoiler]
  s = s.replace(/\[spoiler\]([\s\S]*?)\[\/spoiler\]/g, (_, inner) => {
    const lines = inner.trim().split('\n');
    const title = lines[0];
    const body = lines.slice(1).join('\n');
    return `<details class="doc-spoiler"><summary>${title}</summary><div class="doc-spoiler-body">${parseDocMarkup(unescHtml(body))}</div></details>`;
  });

  // [quote]
  s = s.replace(/\[quote\]([\s\S]*?)\[\/quote\]/g, (_, inner) => {
    let cite = '';
    inner = inner.replace(/\[cite\](.*?)\[\/cite\]/g, (__, c) => { cite = c; return ''; });
    return `<div class="doc-quote">${inner.trim()}${cite ? `<cite>— ${cite}</cite>` : ''}</div>`;
  });

  // [box]
  s = s.replace(/\[box(\s+\w+)?\]([\s\S]*?)\[\/box\]/g, (_, cls, inner) => {
    const type = cls ? cls.trim() : '';
    return `<div class="info-box${type ? ' ' + type : ''}">${inner.trim()}</div>`;
  });

  // [badge]
  s = s.replace(/\[badge\s+(\w+)\](.*?)\[\/badge\]/g, (_, cls, txt) => `<span class="badge ${cls}">${txt}</span>`);

  // [divider]
  s = s.replace(/\[divider\](.*?)\[\/divider\]/g, (_, t) => `<div class="doc-divider">${t}</div>`);

  // [b]
  s = s.replace(/\[b\](.*?)\[\/b\]/g, '<strong>$1</strong>');

  // inline code
  s = s.replace(/`([^`]+)`/g, '<code>$1</code>');

  // headings
  s = s.replace(/^### (.+)$/gm, '<h3>$1</h3>');
  s = s.replace(/^## (.+)$/gm, '<h2>$1</h2>');

  // list items
  s = s.replace(/^- (.+)$/gm, '<li>$1</li>');
  s = s.replace(/(<li>.*<\/li>(\n|$))+/g, m => `<ul>${m}</ul>`);

  // paragraphs
  const lines = s.split('\n');
  const out = [];
  for (let ln of lines) {
    const t = ln.trim();
    if (!t) { out.push(''); continue; }
    if (/^<(h[123]|ul|li|div|table|details|thead|tbody|tr|th|td)/.test(t) || /^<\/(ul|div|table|details|thead|tbody|tr|th|td)/.test(t)) {
      out.push(t); continue;
    }
    out.push(`<p>${t}</p>`);
  }
  return out.join('\n');
}

function escHtml(s) {
  return String(s).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
}
function unescHtml(s) {
  return s.replace(/&amp;/g, '&').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&quot;/g, '"');
}

// ══════════════════════════════════════════════════════
// RENDER DOCS
// ══════════════════════════════════════════════════════
function getDocsWithGuide() {
  return getDocs();
}

function renderDocs() {
  const docs = getDocsWithGuide();
  const sidebar = document.getElementById('docsSidebar');
  const content = document.getElementById('docsContent');
  if (!sidebar || !content) return;

  const cats = {};
  docs.forEach(d => { if (!cats[d.category]) cats[d.category] = []; cats[d.category].push(d); });

  let sidebarHtml = '';
  for (const [cat, items] of Object.entries(cats)) {
    sidebarHtml += `<div class="sidebar-section"><div class="sidebar-section-title">${escHtml(cat)}</div>`;
    items.forEach(d => {
      const active = d.id === (currentDocId !== null ? currentDocId : docs[0]?.id) ? ' active' : '';
      sidebarHtml += `<div class="sidebar-link${active}" onclick="showDoc(${d.id}, this)">
        <span>${escHtml(d.title)}</span>
        ${isAdmin ? `<span class="sidebar-link-actions">
          <button class="sidebar-btn" onclick="event.stopPropagation();openEditDoc(${d.id})" title="Редактировать">✏</button>
          <button class="sidebar-btn del" onclick="event.stopPropagation();deleteDoc(${d.id})" title="Удалить">✕</button>
        </span>` : ''}
      </div>`;
    });
    sidebarHtml += '</div>';
  }
  sidebar.innerHTML = sidebarHtml;

  let contentHtml = '';
  docs.forEach(d => {
    const active = d.id === (currentDocId !== null ? currentDocId : docs[0]?.id) ? ' active' : '';
    contentHtml += `<div class="doc-section${active}" id="doc-${d.id}">
      <h1>${escHtml(d.title)}</h1>
      <p class="doc-lead">${escHtml(d.lead)}</p>
      ${parseDocMarkup(d.body)}
      ${isAdmin ? `<div class="doc-section-actions">
        <button class="btn-edit" onclick="openEditDoc(${d.id})">✏️ Редактировать раздел</button>
        <button class="btn-danger" onclick="deleteDoc(${d.id})">🗑 Удалить раздел</button>
      </div>` : ''}
    </div>`;
  });
  content.innerHTML = contentHtml;

  if (currentDocId === null && docs.length > 0) currentDocId = docs[0].id;
}

function showDoc(id, linkEl) {
  currentDocId = id;
  document.querySelectorAll('.doc-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
  const sec = document.getElementById('doc-' + id);
  if (sec) sec.classList.add('active');
  if (linkEl) linkEl.classList.add('active');
}

// ══════════════════════════════════════════════════════
// DOC CRUD
// ══════════════════════════════════════════════════════
function openAddDoc() {
  editingDocId = null;
  document.getElementById('docFormTitle').textContent = '➕ Новый раздел';
  document.getElementById('docFormCat').value = '';
  document.getElementById('docFormHeading').value = '';
  document.getElementById('docFormLead').value = '';
  document.getElementById('docFormBody').value = '';
  document.getElementById('docModal').classList.add('open');
}

function openEditDoc(id) {
  const docs = getDocs();
  const doc = docs.find(d => d.id === id);
  if (!doc) return;
  editingDocId = id;
  document.getElementById('docFormTitle').textContent = '✏️ Редактировать раздел';
  document.getElementById('docFormCat').value = doc.category;
  document.getElementById('docFormHeading').value = doc.title;
  document.getElementById('docFormLead').value = doc.lead;
  document.getElementById('docFormBody').value = doc.body;
  document.getElementById('docModal').classList.add('open');
}

function closeDocModal() { document.getElementById('docModal').classList.remove('open'); }

function saveDocForm() {
  const cat = document.getElementById('docFormCat').value.trim();
  const title = document.getElementById('docFormHeading').value.trim();
  const lead = document.getElementById('docFormLead').value.trim();
  const body = document.getElementById('docFormBody').value;
  if (!cat || !title) { alert('Заполните категорию и заголовок.'); return; }
  let docs = getDocs();
  if (editingDocId !== null) {
    docs = docs.map(d => d.id === editingDocId ? { ...d, category: cat, title, lead, body } : d);
    currentDocId = editingDocId;
  } else {
    const newId = Date.now();
    docs.push({ id: newId, category: cat, title, lead, body });
    currentDocId = newId;
  }
  saveDocs(docs);
  closeDocModal();
  renderDocs();
}

function deleteDoc(id) {
  if (!confirm('Удалить этот раздел документации?')) return;
  let docs = getDocs().filter(d => d.id !== id);
  saveDocs(docs);
  const allDocs = getDocsWithGuide();
  currentDocId = allDocs.length > 0 ? allDocs[0].id : null;
  renderDocs();
}

function ins(text) {
  const ta = document.getElementById('docFormBody');
  if (!ta) return;
  const start = ta.selectionStart, end = ta.selectionEnd;
  ta.value = ta.value.substring(0, start) + text + ta.value.substring(end);
  ta.selectionStart = ta.selectionEnd = start + text.length;
  ta.focus();
}

// ══════════════════════════════════════════════════════
// NEWS
// ══════════════════════════════════════════════════════
const DEFAULT_NEWS = [
  { id:1, type:'update', typeLabel:'Обновление', date:'22.02.2026', title:'SmartBarrel v1.7 — Уникальный режим магазина', text:'Добавлен режим «Уникальные предметы» для бочек-магазинов. Теперь можно продавать разные предметы с индивидуальными ценами в одной бочке — как в баре. Также исправлены дюп-баги и расширен склад бара до 54 слотов.', tags:['SmartBarrel','Экономика','Фикс'] },
  { id:2, type:'update', typeLabel:'Обновление', date:'22.02.2026', title:'EternalBorder v2.0 — Стабильный релиз', text:'Полный рефакторинг плагина барьера. Модульная архитектура, исправлены утечки памяти, добавлена интеграция с TradeExperience. Опыт от BioMarket теперь идёт напрямую в банк барьера без дублирования.', tags:['EternalBorder','Барьер','Стабильность'] },
  { id:3, type:'announce', typeLabel:'Анонс', date:'23.02.2026', title:'Столица и система ПВП — в разработке', text:'Официально подтверждена новая концепция: единый стартовый город (Столица) с РП-постройками, платной защитой и доской найма. За пределами Столицы — полное ПВП с рейдами баз.', tags:['Столица','ПВП','Анонс'] },
  { id:4, type:'event', typeLabel:'Событие', date:'19.02.2026', title:'Войны фракций — механика подтверждена', text:'Система городов и фракций официально войдёт в сервер при росте онлайна. Прописана полная механика: основание городов, объявление войн, захват структур, дипломатия и наёмники.', tags:['Фракции','Войны','Планы'] }
];

function getNews() { try { const s = localStorage.getItem('blissfull_news'); return s ? JSON.parse(s) : DEFAULT_NEWS; } catch(e) { return DEFAULT_NEWS; } }
function saveNews(news) { try { localStorage.setItem('blissfull_news', JSON.stringify(news)); } catch(e) {} }

function renderNews() {
  const news = getNews();
  const container = document.getElementById('newsList');
  if (!container) return;
  container.innerHTML = news.map(n => `
    <div class="news-card type-${n.type}">
      <div class="news-meta"><span class="news-type">${escHtml(n.typeLabel||n.type)}</span><span class="news-date">${escHtml(n.date)}</span></div>
      <h2>${escHtml(n.title)}</h2>
      <p>${escHtml(n.text)}</p>
      <div class="news-tags">${(n.tags||[]).map(t=>`<span class="news-tag">${escHtml(t)}</span>`).join('')}</div>
      ${isAdmin ? `<div class="news-actions"><button class="btn-edit" onclick="openEditNews(${n.id})">✏️ Редактировать</button><button class="btn-danger" onclick="deleteNews(${n.id})">🗑 Удалить</button></div>` : ''}
    </div>`).join('');
}

function openAddNews() {
  editingNewsId = null;
  document.getElementById('newsFormTitle').textContent = '➕ Добавить новость';
  document.getElementById('newsFormType').value = 'update';
  document.getElementById('newsFormDate').value = new Date().toLocaleDateString('ru-RU');
  document.getElementById('newsFormTitle2').value = '';
  document.getElementById('newsFormText').value = '';
  document.getElementById('newsFormTags').value = '';
  document.getElementById('newsModal').classList.add('open');
}

function openEditNews(id) {
  const n = getNews().find(x => x.id === id);
  if (!n) return;
  editingNewsId = id;
  document.getElementById('newsFormTitle').textContent = '✏️ Редактировать новость';
  document.getElementById('newsFormType').value = n.type;
  document.getElementById('newsFormDate').value = n.date;
  document.getElementById('newsFormTitle2').value = n.title;
  document.getElementById('newsFormText').value = n.text;
  document.getElementById('newsFormTags').value = (n.tags||[]).join(', ');
  document.getElementById('newsModal').classList.add('open');
}

function closeNewsModal() { document.getElementById('newsModal').classList.remove('open'); }

function saveNewsForm() {
  const type = document.getElementById('newsFormType').value;
  const date = document.getElementById('newsFormDate').value.trim();
  const title = document.getElementById('newsFormTitle2').value.trim();
  const text = document.getElementById('newsFormText').value.trim();
  const tagsRaw = document.getElementById('newsFormTags').value.trim();
  const tags = tagsRaw ? tagsRaw.split(',').map(t => t.trim()).filter(Boolean) : [];
  const LABELS = { update:'Обновление', event:'Событие', announce:'Анонс', fix:'Фикс', info:'Инфо' };
  if (!title || !text) { alert('Заполните заголовок и текст новости.'); return; }
  let news = getNews();
  if (editingNewsId !== null) {
    news = news.map(n => n.id === editingNewsId ? { ...n, type, typeLabel: LABELS[type]||type, date, title, text, tags } : n);
  } else {
    news.unshift({ id: Date.now(), type, typeLabel: LABELS[type]||type, date, title, text, tags });
  }
  saveNews(news); closeNewsModal(); renderNews();
}

function deleteNews(id) {
  if (!confirm('Удалить эту новость?')) return;
  saveNews(getNews().filter(n => n.id !== id)); renderNews();
}

// ══════════════════════════════════════════════════════
// ADMIN AUTH
// ══════════════════════════════════════════════════════
function openAdminLogin() {
  document.getElementById('adminLoginModal').classList.add('open');
  document.getElementById('adminPassInput').value = '';
  setTimeout(() => document.getElementById('adminPassInput').focus(), 100);
  document.getElementById('adminLoginError').style.display = 'none';
}
function closeAdminLogin() { document.getElementById('adminLoginModal').classList.remove('open'); }

async function doAdminLogin() {
  const val = document.getElementById('adminPassInput').value;
  if (!val) return;
  const btn = document.querySelector('#adminLoginModal .btn-submit');
  const err = document.getElementById('adminLoginError');
  btn.textContent = 'Проверка...'; btn.disabled = true; err.style.display = 'none';
  try {
    const resp = await fetch(AUTH_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ password: val }) });
    const data = await resp.json();
    if (data.ok) {
      isAdmin = true;
      closeAdminLogin();
      document.getElementById('adminBar').style.display = '';
      document.getElementById('docsAdminBar').style.display = '';
      renderNews(); renderDocs();
    } else {
      err.textContent = resp.status === 429 ? 'Слишком много попыток, подожди минуту' : 'Неверный пароль';
      err.style.display = 'block';
      document.getElementById('adminPassInput').value = '';
      document.getElementById('adminPassInput').focus();
    }
  } catch(e) { err.textContent = 'Ошибка соединения с сервером'; err.style.display = 'block'; }
  finally { btn.textContent = 'Войти'; btn.disabled = false; }
}

function adminLogout() {
  isAdmin = false;
  document.getElementById('adminBar').style.display = 'none';
  document.getElementById('docsAdminBar').style.display = 'none';
  renderNews(); renderDocs();
}

// ══════════════════════════════════════════════════════
// PAGE NAV
// ══════════════════════════════════════════════════════
function showPage(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-links a').forEach(a => a.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.getElementById('nav-' + id).classList.add('active');
  window.scrollTo(0, 0);
  if (id === 'news') renderNews();
  if (id === 'docs') renderDocs();
}

function copyIP() {
  navigator.clipboard.writeText('blissfull.mc-server.net:25816').catch(() => {});
  const toast = document.getElementById('copyToast');
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 2000);
}

// ══════════════════════════════════════════════════════
// SERVER STATUS
// ══════════════════════════════════════════════════════
async function fetchServerStatus() {
  try {
    const resp = await fetch('https://api.mcsrvstat.us/3/blissfull.mc-server.net:25816');
    if (!resp.ok) throw new Error();
    updateServerUI(await resp.json());
  } catch(e) { updateServerUI(null); }
}

function updateServerUI(data) {
  const online = data && data.online;
  const players = online && data.players ? data.players.online : 0;
  const max = online && data.players ? data.players.max : 0;
  const version = online && data.version ? data.version : '1.21.x';
  const badge = document.querySelector('.hero-badge');
  if (badge) {
    badge.innerHTML = (online ? ' Сервер онлайн' : ' Сервер офлайн');
    badge.style.borderColor = online ? 'rgba(0,255,136,0.25)' : 'rgba(255,68,85,0.25)';
    badge.style.background = online ? 'rgba(0,255,136,0.08)' : 'rgba(255,68,85,0.08)';
  }
  const hp = document.getElementById('hero-players'), hs = document.getElementById('hero-status'), hv = document.getElementById('hero-version');
  if (hp) { hp.textContent = online ? players : '—'; hp.style.color = online ? 'var(--green)' : 'var(--red)'; }
  if (hs) { hs.textContent = online ? 'Онлайн' : 'Офлайн'; hs.style.color = online ? 'var(--green)' : 'var(--red)'; }
  if (hv) hv.textContent = version;
  const dot = document.getElementById('sidebar-dot'), st = document.getElementById('sidebar-status-text');
  const sp = document.getElementById('sidebar-players'), sm = document.getElementById('sidebar-max'), sv = document.getElementById('sidebar-version');
  if (dot) dot.className = 'status-dot' + (online ? '' : ' offline');
  if (st) st.textContent = online ? 'Онлайн' : 'Офлайн';
  if (sp) { sp.textContent = online ? players : '—'; sp.style.color = online ? 'var(--green)' : 'var(--red)'; }
  if (sm) sm.textContent = online && max ? `/ ${max}` : '';
  if (sv) sv.textContent = version;
}

// INIT
renderNews();
renderDocs();
fetchServerStatus();
setInterval(fetchServerStatus, 60000);

document.addEventListener('keydown', e => {
  if (e.key === 'Escape') {
    document.getElementById('newsModal').classList.remove('open');
    document.getElementById('adminLoginModal').classList.remove('open');
    document.getElementById('docModal').classList.remove('open');
  }
});
</script>
</body>
</html>
